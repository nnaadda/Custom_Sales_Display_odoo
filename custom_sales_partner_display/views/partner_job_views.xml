<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        
        <!-- Search View for Customer Jobs -->
        <record id="view_partner_job_search" model="ir.ui.view">
            <field name="name">customer.jobs.search</field>
            <field name="model">res.partner</field>
            <field name="type">search</field>
            <field name="arch" type="xml">
                <search string="Search Customer Jobs">
                    <field name="name" string="Customer Name" 
                           filter_domain="[('name', 'ilike', self)]"/>
                    <field name="function" string="Job Position" 
                           filter_domain="[('function', 'ilike', self)]"/>
                    <field name="email" string="Email" 
                           filter_domain="[('email', 'ilike', self)]"/>
                    <field name="parent_id" string="Company" 
                           filter_domain="[('parent_id', 'ilike', self)]"/>
                    <field name="category_id" string="Tags"/>
                    
                    <separator/>
                    
                    <!-- Filters -->
                    <filter string="Has Job Position" name="has_job" 
                            domain="[('function', '!=', False)]"/>
                    <filter string="No Job Position" name="no_job" 
                            domain="[('function', '=', False)]"/>
                    <filter string="Has Email" name="has_email" 
                            domain="[('email', '!=', False)]"/>
                    <filter string="Has Phone" name="has_phone" 
                            domain="['|', ('phone', '!=', False), ('mobile', '!=', False)]"/>
                    <filter string="Customers" name="customers" 
                            domain="[('customer_rank', '>', 0)]"/>
                    <filter string="Suppliers" name="suppliers" 
                            domain="[('supplier_rank', '>', 0)]"/>
                    <filter string="Active" name="active" 
                            domain="[('active', '=', True)]"/>
                    <filter string="Archived" name="inactive" 
                            domain="[('active', '=', False)]"/>
                    
                    <separator/>
                    
                    <!-- Group By -->
                    <group expand="0" string="Group By">
                        <filter string="Job Position" name="group_function" 
                                domain="[]" context="{'group_by': 'function'}"/>
                        <filter string="Company" name="group_company" 
                                domain="[]" context="{'group_by': 'parent_id'}"/>
                        <filter string="Country" name="group_country" 
                                domain="[]" context="{'group_by': 'country_id'}"/>
                        <filter string="Tags" name="group_tags" 
                                domain="[]" context="{'group_by': 'category_id'}"/>
                        <filter string="Creation Date" name="group_create_date" 
                                domain="[]" context="{'group_by': 'create_date'}"/>
                    </group>
                </search>
            </field>
        </record>

        <!-- List View for Customer Jobs -->
        <record id="view_partner_job_tree" model="ir.ui.view">
            <field name="name">customer.jobs.list</field>
            <field name="model">res.partner</field>
            <field name="type">list</field>
            <field name="arch" type="xml">
                <list string="Customer Job Positions" editable="bottom" multi_edit="1" sample="1">
                    <field name="name" required="1"/>
                    <field name="function" string="Job Position"/>
                    <field name="email" widget="email" optional="show"/>
                    <field name="phone" widget="phone" optional="show"/>
                    <field name="mobile" widget="phone" optional="hide"/>
                    <field name="parent_id" string="Company" domain="[('is_company', '=', True)]" optional="show"/>
                    <field name="country_id" optional="hide"/>
                    <field name="city" optional="hide"/>
                    <field name="website" widget="url" optional="hide"/>
                    <field name="category_id" widget="many2many_tags" options="{'color_field': 'color'}" optional="show"/>
                    <field name="user_id" string="Salesperson" optional="hide"/>
                    <field name="create_date" string="Created On" optional="hide"/>
                    <field name="activity_ids" widget="list_activity" optional="show"/>
                    <field name="is_company" invisible="1"/>
                    <field name="active" invisible="1"/>
                </list>
            </field>
        </record>

        <!-- Graph View for Customer Jobs Analytics -->
        <record id="view_partner_job_graph" model="ir.ui.view">
            <field name="name">customer.jobs.graph</field>
            <field name="model">res.partner</field>
            <field name="type">graph</field>
            <field name="arch" type="xml">
                <graph string="Customer Jobs Chart" type="bar" sample="1">
                    <field name="function"/>
                    <field name="id" type="measure"/>
                </graph>
            </field>
        </record>

        <!-- Calendar View for Customer Activities -->
        <record id="view_partner_job_calendar" model="ir.ui.view">
            <field name="name">customer.jobs.calendar</field>
            <field name="model">res.partner</field>
            <field name="type">calendar</field>
            <field name="arch" type="xml">
                <calendar string="Customer Events" date_start="create_date" color="function" mode="month">
                    <field name="name"/>
                    <field name="function"/>
                    <field name="email"/>
                    <field name="phone"/>
                </calendar>
            </field>
        </record>

        <!-- Activity View -->
        <record id="view_partner_job_activity" model="ir.ui.view">
            <field name="name">customer.jobs.activity</field>
            <field name="model">res.partner</field>
            <field name="type">activity</field>
            <field name="arch" type="xml">
                <activity string="Customer Activities">
                    <field name="id"/>
                    <templates>
                        <div t-name="activity-box">
                            <img t-att-src="activity_image('res.partner', 'avatar_128', record.id.raw_value)" 
                                 role="img" t-att-title="record.id.value" t-att-alt="record.id.value"/>
                            <div>
                                <strong><field name="name"/></strong>
                                <div t-if="record.function.value">
                                    <i class="fa fa-briefcase"/> <field name="function"/>
                                </div>
                                <div t-if="record.email.value">
                                    <i class="fa fa-envelope"/> <field name="email"/>
                                </div>
                            </div>
                        </div>
                    </templates>
                </activity>
            </field>
        </record>

        <!-- Form View for Customer Jobs -->
        <record id="view_partner_job_form" model="ir.ui.view">
            <field name="name">customer.jobs.form</field>
            <field name="model">res.partner</field>
            <field name="type">form</field>
            <field name="arch" type="xml">
                <form string="Customer Job Information">
                    <header>
                        <button name="action_view_partner_invoices" type="object" 
                                class="btn-primary" string="View Invoices" 
                                invisible="customer_rank == 0"/>
                    </header>
                    
                    <sheet>
                        <div class="oe_button_box" name="button_box">
                            <button name="toggle_active" type="object" class="oe_stat_button" icon="fa-archive">
                                <field name="active" widget="boolean_button" options='{"terminology": "archive"}'/>
                            </button>
                        </div>
                        
                        <widget name="web_ribbon" title="Archived" bg_color="bg-danger" 
                                invisible="active == True"/>
                        
                        <field name="avatar_128" widget="image" class="oe_avatar" 
                               options="{'preview_image': 'avatar_128', 'size': [90, 90]}"/>
                        
                        <div class="oe_title">
                            <h1>
                                <field name="name" placeholder="Customer Name" required="1"/>
                            </h1>
                            <h3>
                                <field name="function" placeholder="Job Position/Title"/>
                            </h3>
                        </div>
                        
                        <group>
                            <group>
                                <field name="is_company" invisible="1"/>
                                <field name="company_type" widget="radio" options="{'horizontal': true}"/>
                                <field name="parent_id" domain="[('is_company', '=', True)]" 
                                       context="{'default_is_company': True}"/>
                                <field name="title" placeholder="e.g. Mr., Mrs."/>
                            </group>
                            <group>
                                <field name="category_id" widget="many2many_tags" 
                                       options="{'color_field': 'color', 'no_create_edit': True}" 
                                       placeholder="Tags..."/>
                                <field name="lang"/>
                                <field name="tz" string="Timezone"/>
                            </group>
                        </group>
                        
                        <notebook>
                            <page string="Contact &amp; Address" name="contact_address">
                                <group>
                                    <group string="Contact Information">
                                        <field name="email" widget="email"/>
                                        <field name="mobile" widget="phone"/>
                                    </group>
                                    <group string="Address">
                                        <label for="street" string="Address"/>
                                        <div class="o_address_format">
                                            <field name="street" placeholder="Street..." class="o_address_street"/>
                                            <field name="street2" placeholder="Street 2..." class="o_address_street"/>
                                            <field name="city" placeholder="City" class="o_address_city"/>
                                            <field name="state_id" class="o_address_state" 
                                                   placeholder="State" options='{"no_open": True, "no_quick_create": True}' 
                                                   context="{'country_id': country_id, 'default_country_id': country_id, 'zip': zip}"/>
                                            <field name="zip" placeholder="ZIP" class="o_address_zip"/>
                                            <field name="country_id" placeholder="Country" 
                                                   class="o_address_country" options='{"no_open": True, "no_create": True}'/>
                                        </div>
                                    </group>
                                </group>
                            </page>
                            
                            <page string="Professional Info" name="job_details">
                                <group>
                                    <group string="Job Information">
                                        <field name="function"/>
                                        <field name="title"/>
                                        <field name="user_id" string="Salesperson"/>
                                    </group>
                                    <group string="Company Information">
                                        <field name="company_id" groups="base.group_multi_company" 
                                               options="{'no_create': True}"/>
                                    </group>
                                </group>
                                
                                <group string="Additional Info">
                                    <group>
                                        <field name="ref" string="Internal Reference"/>
                                    </group>

                                </group>
                            </page>
                            
                            <page string="Sales &amp; Purchase" name="sales_purchase">
                                <group>
                                    <group string="Sales Information">
                                        <field name="customer_rank"/>
                                        <field name="is_company" invisible="1"/>
                                        <field name="property_payment_term_id" string="Customer Payment Terms" 
                                               options="{'no_create': True}"/>
                                        <field name="property_product_pricelist" string="Pricelist" 
                                               options="{'no_create': True}"/>
                                    </group>
                                    <group string="Purchase Information">
                                        <field name="supplier_rank"/>
                                        <field name="property_supplier_payment_term_id" string="Vendor Payment Terms" 
                                               options="{'no_create': True}"/>
                                    </group>
                                </group>
                                
                                <group string="Fiscal Information">
                                    <group>
                                        <field name="property_account_position_id" string="Fiscal Position" 
                                               options="{'no_create': True}"/>
                                    </group>
                                    <group>
                                        <field name="credit_limit"/>
                                    </group>
                                </group>
                            </page>
                            
                            <page string="Internal Notes" name="internal_notes">
                                <field name="comment" placeholder="Internal notes..." nolabel="1"/>
                            </page>
                        </notebook>
                    </sheet>
                    
                    <div class="oe_chatter">
                        <field name="message_follower_ids" groups="base.group_user"/>
                        <field name="activity_ids"/>
                        <field name="message_ids"/>
                    </div>
                </form>
            </field>
        </record>

        <!-- Kanban View for Customer Jobs -->
        <record id="view_partner_job_kanban" model="ir.ui.view">
            <field name="name">customer.jobs.kanban</field>
            <field name="model">res.partner</field>
            <field name="type">kanban</field>
            <field name="arch" type="xml">
                <kanban string="Customer Job Positions" class="o_res_partner_kanban" quick_create="false" sample="1">
                    <field name="id"/>
                    <field name="name"/>
                    <field name="function"/>
                    <field name="email"/>
                    <field name="phone"/>
                    <field name="mobile"/>
                    <field name="category_id"/>
                    <field name="is_company"/>
                    <field name="avatar_128"/>
                    <field name="country_id"/>
                    <field name="parent_id"/>
                    <field name="user_id"/>
                    <field name="activity_ids"/>
                    <field name="activity_state"/>
                    
                    <templates>
                        <t t-name="kanban-box">
                            <div class="oe_kanban_global_click o_kanban_record_has_image_fill">
                                <t t-if="record.activity_state.raw_value">
                                    <div class="oe_kanban_top_left">
                                        <i class="fa fa-clock-o" t-att-class="'oe_activity_deadline_' + record.activity_state.raw_value"/>
                                    </div>
                                </t>
                                
                                <div class="o_kanban_image_fill_left d-none d-md-block" 
                                     t-attf-style="background-image: url(#{kanban_image('res.partner', 'avatar_128', record.id.raw_value)})"/>
                                
                                <div class="oe_kanban_details">
                                    <div class="o_kanban_record_top mb-2">
                                        <div class="o_kanban_record_headings">
                                            <strong class="o_kanban_record_title">
                                                <field name="name"/>
                                            </strong>
                                        </div>
                                        <div class="o_kanban_manage_button_section">
                                            <a class="o_kanban_manage_toggle_button" href="#">
                                                <i class="fa fa-ellipsis-v" role="img" aria-label="Manage" title="Manage"/>
                                            </a>
                                        </div>
                                    </div>
                                    
                                    <div t-if="record.function.raw_value" class="o_kanban_record_subtitle">
                                        <i class="fa fa-briefcase me-1"/> <field name="function"/>
                                    </div>
                                    
                                    <div t-if="record.parent_id.raw_value" class="o_kanban_record_subtitle">
                                        <i class="fa fa-building me-1"/> <field name="parent_id"/>
                                    </div>
                                    
                                    <div class="o_kanban_record_body">
                                        <div t-if="record.email.raw_value">
                                            <i class="fa fa-envelope me-1"/> <field name="email"/>
                                        </div>
                                        <div t-if="record.phone.raw_value">
                                            <i class="fa fa-phone me-1"/> <field name="phone"/>
                                        </div>
                                        <div t-if="record.mobile.raw_value">
                                            <i class="fa fa-mobile me-1"/> <field name="mobile"/>
                                        </div>
                                        <div t-if="record.country_id.raw_value">
                                            <i class="fa fa-globe me-1"/> <field name="country_id"/>
                                        </div>
                                    </div>
                                    
                                    <div t-if="record.category_id.raw_value" class="oe_kanban_partner_categories mt-1">
                                        <field name="category_id" widget="many2many_tags" options="{'color_field': 'color'}"/>
                                    </div>
                                    
                                    <div class="o_kanban_record_bottom mt-2">
                                        <div class="oe_kanban_bottom_left">
                                            <div t-if="record.user_id.raw_value" class="o_kanban_inline_block">
                                                <img t-att-src="kanban_image('res.users', 'avatar_128', record.user_id.raw_value)"
                                                     t-att-title="record.user_id.value" t-att-alt="record.user_id.value"
                                                     width="24" height="24" class="oe_kanban_avatar me-1"/>
                                                <field name="user_id"/>
                                            </div>
                                        </div>
                                        <div class="oe_kanban_bottom_right">
                                            <field name="activity_ids" widget="kanban_activity"/>
                                        </div>
                                    </div>
                                    
                                    <div class="o_dropdown_kanban dropdown" groups="base.group_user">
                                        <a role="button" class="dropdown-toggle o-no-caret btn" data-bs-toggle="dropdown" 
                                           href="#" aria-label="Dropdown menu" title="Dropdown menu">
                                            <span class="fa fa-ellipsis-v"/>
                                        </a>
                                        <div class="dropdown-menu" role="menu">
                                            <t t-if="widget.editable">
                                                <a role="menuitem" type="edit" class="dropdown-item">Edit</a>
                                            </t>
                                            <t t-if="widget.deletable">
                                                <a role="menuitem" type="delete" class="dropdown-item">Delete</a>
                                            </t>
                                            <a role="menuitem" class="dropdown-item" name="action_view_partner_invoices" type="object">
                                                View Invoices
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </t>
                    </templates>
                </kanban>
            </field>
        </record>

        <!-- Action for Customer Jobs with all views -->
        <record id="action_partner_job_positions" model="ir.actions.act_window">
            <field name="name">Customer Job Positions</field>
            <field name="res_model">res.partner</field>
            <field name="view_mode">kanban,list,form,calendar,graph,activity</field>
            <field name="domain">[('is_company', '=', False), ('customer_rank', '>', 0)]</field>
            <field name="context">{
                'default_is_company': False,
                'default_customer_rank': 1,
                'show_job_in_name': True,
                'search_default_has_job': 1
            }</field>
            <field name="search_view_id" ref="view_partner_job_search"/>
            <field name="help" type="html">
                <p class="o_view_nocontent_smiling_face">
                    Create your first customer contact with job position
                </p>
                <p>
                    This comprehensive view allows you to manage customer contacts with their professional information.
                    You can track job positions, contact details, and analyze customer data across multiple view types.
                </p>
            </field>
        </record>

    </data>
</odoo>